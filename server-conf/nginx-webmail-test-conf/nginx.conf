user www-data;
pid /run/nginx.pid;
worker_processes 8;
error_log /etc/nginx/logs/error.log;
events
{
    use epoll;
    worker_connections 8192;
}
http
{
    include mime.types;
    proxy_set_header Host $host;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-From-IP $remote_addr;
    proxy_set_header X-Forwarded-Proto $scheme;
    proxy_set_header X-Remote-Port $remote_port;
    proxy_set_header X-Request-Scheme $scheme;
    default_type application/octet-stream;
    #log_format main '$remote_addr $request_length $request_time [$time_local] "$request" $status $bytes_sent ' '$http_host "$proxy_add_x_forwarded_for" "$http_referer" $upstream_addr $upstream_response_time' ' "$http_user_agent"';
    log_format main '$remote_addr - $remote_user [$time_local] "$request" '
        '$status $body_bytes_sent "$http_referer" "X" '
        '"$host" $upstream_response_time $upstream_addr $upstream_status $request_time $mail_realhost_1 "$http_user_agent"';
    log_format police_download '$remote_addr $request_length $request_time [$time_local] "$request" $status $bytes_sent ' '$http_host "$proxy_add_x_forwarded_for" "$http_referer" $upstream_addr $upstream_response_time' ' "$http_user_agent" "$http_authorization"';
    access_log /home/appops/logs/nginx/access.log main;
    server_tokens off;
    gzip on;
    gzip_min_length 1000;
    gzip_types application/x-javascript text/plain application/xml text/xml application/xhtml+xml text/css text/javascript;
    sendfile on;
    port_in_redirect on;
    keepalive_timeout 60;
    keepalive_requests 5000;
    log_not_found on;
    client_max_body_size 150M;
    client_header_buffer_size 16k;
    large_client_header_buffers 8 32k;
    client_body_timeout 300;
    client_body_buffer_size 3072k;



    map $cookie_Coremail $mail_realhost_1 {
        default entmail-test-06;
        ~^.+%(?P<hostvar1>.*)$ $hostvar1;
    }

    map $mail_realhost_1 $mail_realhost_ip1 {
        "entmail-test-02" "10.150.0.3";
        "entmail-test-03" "10.150.0.4";
        "entmail-test-04" "10.150.0.2";
        "entmail-test-05" "10.150.0.6";
        "entmail-test-06" "10.150.0.9";
        "entmail-test-07" "10.150.0.8";
        "entmail-test-08" "10.150.0.7";
        "entmail-test-10" "10.150.0.44";
    }

    upstream calendar
    {
        server 10.150.0.2:8080;
    }
    upstream APOLLO
    {
        server 10.150.0.7:8070;
    }
    upstream QIYEFACE
    {
        server 10.150.0.7:8099;
    }
    upstream APOLLOCONFIG
    {
        server 10.150.0.7:8080;
    }
    upstream RABBITMQ
    {
        server 10.150.0.6:15672;
    }
    upstream QIYESALE
    {
        server 10.200.217.236:18080;
    }
    upstream RDMAILQUERY {
        server 10.150.0.3:8080;
    }
    upstream MAILADMINSERVER
    {
        server mail-admin.cowork-i.netease.com;
    }
    upstream QIYELOGIN
    {
        server 10.150.0.9:8686;
    }
    upstream CONTACT
    {
        server 10.150.0.7:9696;
    }
    upstream QIYEPUSH
    {
        server 10.150.0.9:8090;
    }
    upstream MAILAPP
    {
        server 10.150.0.9:8080;
    }
    upstream WEBMAIL
    {
        server 10.150.0.9:8181;
    }
    upstream ES
    {
        server 10.150.0.8:9200;
    }
    upstream KIBANA
    {
        server 10.150.0.8:5601;
    }
    upstream XXL-JOB
    {
        server 10.150.0.7:18089;
    }
    upstream WEBAPP
    {
        server 10.150.0.3:8080;
    }
    upstream OPENAPP
    {
        server 10.150.0.8:8080;
    }
    upstream QIYECONFIG
    {
        server 10.150.0.8:9090;
    }
    upstream IPLOCATOR
    {
        server 10.150.0.9:8550;
    }
    upstream QIYEEDM
    {
        server 10.150.0.5:18090;
    }
    upstream WEWORK_API
    {
        server 10.150.0.4:9080;
    }
    upstream ROOT
    {
        server 10.150.0.9:8080;
    }
    upstream localhost
    {
        server 10.150.0.9:8888;
    }
    #静态资源服务
    server
    {
        listen 80;
        listen 443 ssl;
        server_name mimgdev.netease.com mimghz.qiye.163.com mimg.qiye.163.com mimgdev.qiye.163.com wmsvr.qiye.163.com qiye-wmsvr.netease.com;
        ssl_certificate qiye.163.com.cer.pem;
        ssl_certificate_key qiye.163.com.key.pem;
        ssl_session_cache shared:SSL:5120m;
        ssl_ciphers ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA:ECDHE-RSA-AES256-SHA:DHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA:DHE-RSA-AES256-SHA256:DHE-RSA-AES256-SHA:ECDHE-ECDSA-DES-CBC3-SHA:ECDHE-RSA-DES-CBC3-SHA:EDH-RSA-DES-CBC3-SHA:AES128-GCM-SHA256:AES256-GCM-SHA384:AES128-SHA256:AES256-SHA256:AES128-SHA:AES256-SHA:DES-CBC3-SHA:!DSS;
        ssl_protocols TLSv1 TLSv1.1 TLSv1.2;
        ssl_prefer_server_ciphers on;
        ssl_verify_depth 10;
        ssl_session_timeout 30m;
        location /api-docs/
        {
            root /data/webroot/;
            index wmsvr.html;
        }
        location /
        {
            add_header Access-Control-Allow-Origin "https://mailhz.qiye.163.com";
            add_header Access-Control-Allow-Credentials "true";
            add_header Access-Control-Allow-Methods 'POST,GET,OPTIONS';
            add_header Access-Control-Allow-Headers '*';
            root /data/mimg.qiye.163.com;
        }
    }
    #nos代理
    server
    {
        listen 80;
        server_name nos2-i.service.163.org;
        location /
        {
            proxy_set_header Host $Host;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_pass http://10.130.99.200;
        }
    }
    server
    {
        listen 80;
        server_name nos-jd.service.163.org;
        location /
        {
            proxy_set_header Host $Host;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_pass http://10.196.1.20;
        }
    }
    #内部域名
    server
    {
        listen 80;
        server_name qiye-apollo-dev.service.163.org qiye-domainservice-dev.service.163.org qiye-contacts-dev.service.163.org qiye-push-dev.service.163.org qiye-config-dev.service.163.org qiye-face-dev.service.163.org qiye-commonweb-dev.service.163.org qiye-login-dev.service.163.org qiye-entry-dev.service.163.org qiye-logquery-dev.service.163.org;
        location ~ ^/domainservice
        {
            proxy_pass http://MAILAPP;
        }
        location ~ ^/contacts
        {
            proxy_pass http://CONTACT;
        }
        location ~ ^/configs
        {
            proxy_pass http://APOLLOCONFIG;
        }
        location ~ ^/configfiles
        {
            proxy_pass http://APOLLOCONFIG;
        }
        location ~ ^/qiyepush
        {
            proxy_pass http://QIYEPUSH;
        }
        location ~ ^/qiyeface
        {
            proxy_pass http://QIYEFACE;
        }
        location ~ ^/rdmailquery {
                proxy_pass http://RDMAILQUERY;
        }
        location /config
        {
            proxy_pass http://QIYECONFIG/qiyeconfig/;
            proxy_set_header Host $host;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        }
        location /qiyeconfig
        {
            proxy_pass http://QIYECONFIG/qiyeconfig;
            proxy_set_header Host $host;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        }
        location ~ ^/commonweb
        {
            proxy_pass http://10.150.0.3:8080;
        }
        location ~ ^/login
        {
            proxy_pass http://QIYELOGIN;
            proxy_set_header Host $Host;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        }
        location ~ ^/entry
        {
            proxy_pass http://QIYELOGIN;
            proxy_set_header Host $Host;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        }
    }
    #web
    server
    {
        listen 80 default;
        listen 443 ssl;
        server_name maildev.netease.com maildev.qiye.163.com maildev1.netease.com maildev1.qiye.163.com maildev2.qiye.163.com mail.qiye.163.com mailhz.qiye.163.com hwmail.qiye.163.com dhz.qiye.163.com d.qiye.163.com dev.qiye.163.com webmail.* mail.* mails.* stu.* email.* sd.*;
        ssl_certificate qiye.163.com.cer.pem;
        ssl_certificate_key qiye.163.com.key.pem;
        ssl_session_cache shared:SSL:5120m;
        ssl_ciphers ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA:ECDHE-RSA-AES256-SHA:DHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA:DHE-RSA-AES256-SHA256:DHE-RSA-AES256-SHA:ECDHE-ECDSA-DES-CBC3-SHA:ECDHE-RSA-DES-CBC3-SHA:EDH-RSA-DES-CBC3-SHA:AES128-GCM-SHA256:AES256-GCM-SHA384:AES128-SHA256:AES256-SHA256:AES128-SHA:AES256-SHA:DES-CBC3-SHA:!DSS;
        ssl_protocols TLSv1 TLSv1.1 TLSv1.2;
        ssl_prefer_server_ciphers on;
        ssl_verify_depth 10;
        ssl_session_timeout 30m;

        location /advlock_qiye
        {
            proxy_pass http://WEBAPP;
        }
        location /static/
        {
            root /data/webroot/;
        }
        location /schedulemanager
        {
            proxy_pass http://calendar;
        }
        location /atthview
        {
            proxy_pass http://10.150.0.2:18090;
        }

        location ~ ^/entry
        {
            proxy_pass http://QIYELOGIN;
            proxy_set_header Host $Host;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        }

        location ~ ^/mailapp
        {
            proxy_pass http://10.150.0.3:8080;
        }
        location ~ ^/domain
        {
            proxy_pass http://MAILAPP;
           # proxy_pass http://QIYELOGIN;
            proxy_set_header Host $Host;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        }
        location ~ ^/domainservice
        {
            proxy_pass http://MAILAPP;
        }
        location /qiyeimage/
        {
            proxy_pass http://mailhz.qiye.163.com;
        }
        location ~ ^/commonweb
        {
            proxy_pass http://10.150.0.9:8080;
        }
        location ~ ^/qiyeurs
        {
            proxy_pass http://10.150.0.3:8080;
        }
        location ~ ^/order/api/
        {
            rewrite /order/(.*)$ /$1 break;
            proxy_http_version 1.1;
            proxy_set_header Connection "";
            proxy_pass http://mail-admin-dev.cowork-i.netease.com;
            proxy_set_header Host mail-admin-dev.cowork-i.netease.com;
            proxy_set_header X-real-ip $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        }
        location ~ ^/admin
        {
            proxy_pass http://MAILAPP;
        }
        location ~ ^/rdmailquery
        {
            proxy_pass http://WEBAPP;
        }
        location ~ ^/contacts
        {
            proxy_pass http://CONTACT;
        }
        location ~ ^/configs
        {
            proxy_pass http://APOLLOCONFIG;
        }
        location ~ ^/configfiles
        {
            proxy_pass http://APOLLOCONFIG;
        }
        location ~ ^/preview
        {
            proxy_pass http://10.131.45.22:8080;
        }
        location ~ ^/nfpreview
        {
            proxy_pass http://10.131.45.22:8080;
        }
        location ~ ^/qiyepush
        {
            proxy_pass http://QIYEPUSH;
        }
        location ~ ^/es/
        {
            rewrite /es/(.*)$ /$1 break;
            proxy_pass http://ES;
        }
        location ~ ^/kibana/(.*)$
        {
            rewrite /kibana/(.*)$ /$1 break;
            proxy_pass http://KIBANA;
            proxy_http_version 1.1;
            proxy_set_header Upgrade $http_upgrade;
            proxy_set_header Connection 'upgrade';
            proxy_set_header Host $host;
            proxy_cache_bypass $http_upgrade;
        }
        location ~ ^/xxl-job-admin
        {
            proxy_pass http://XXL-JOB;
        }
        location ~ ^/(jy3/|jy5/|js6/|ios/|qiyeapp/|m/)
        {
            if ($mail_realhost_1) {
                break;
                proxy_pass  http://$mail_realhost_ip1:8181;
            }
        }
        location ~ ^/hmail/
        {
            if ($mail_realhost_1) {
                break;
                proxy_pass  http://$mail_realhost_ip1:8888;
            }
        }
        location ~ ^/hmailapi/
        {

            proxy_pass  http://localhost;

        }
        location ~ ^/login
        {
            root /data/qiye.163.com/;
            index index.html;
        }
        location /
        {
            proxy_pass http://ROOT;
        }
        # ******************** for sirius-web **************************** #
        location /static/sirius-web/
        {
	          access_log /home/appops/logs/nginx/access_static.log main;
	          alias /data/sirius-desktop-web/;
            index index.html index.htm;
        }

         location /lx-web/lxdomain {
             proxy_http_version 1.1;
             proxy_set_header Connection "";

             proxy_set_header Origin https://entrydev.qiye.163.com;
             proxy_set_header Host entrydev.qiye.163.com;
             proxy_set_header X-Forwarded-For $http_X_Forwarded_For;
             proxy_pass http://QIYELOGIN;

             proxy_cookie_path /domain /static/sirius-web;

             rewrite ^/lx-web/lxdomain/(.*) /login/$1 break;
         }

        location /lx-web/bjlxdomain {
            proxy_http_version 1.1;
            proxy_set_header Connection "";
            proxy_set_header Origin https://entrydev.qiye.163.com;
            proxy_set_header Host entrydev.qiye.163.com;
            proxy_set_header X-Forwarded-For $http_X_Forwarded_For;

            proxy_pass http://QIYELOGIN;
            proxy_cookie_path /domain /bjdomain;

            rewrite ^/lx-web/bjlxdomain/(.*) /login/$1 break;
        }

        location /lx-web/edisk/api {
            proxy_http_version 1.1;
            proxy_set_header Connection "";

            proxy_set_header Origin https://edisk-test2.qiye.163.com;
            # proxy_set_header Host edisk.qiye.163.com;
            proxy_set_header Host edisk-test2.qiye.163.com;

            proxy_pass "http://triones-edisk.cowork-i.netease.com";

            rewrite ^/lx-web/edisk/(.*) /$1 break;
        }


        location /lx-web/sirius {
            proxy_http_version 1.1;
            proxy_set_header Connection "";

            proxy_set_header Origin https://sirius-dev1.qiye.163.com;
            proxy_set_header Host sirius-dev1.qiye.163.com;

            proxy_pass "http://sirius-dev1.qiye.163.com";

            rewrite ^/lx-web/sirius/(.*) /$1 break;
        }

        location /lx-web/cowork/api {
            proxy_http_version 1.1;
            proxy_set_header Connection "";

	          access_log /home/appops/logs/nginx/access_contact.log main;
            proxy_set_header Origin https://sirius-dev1.qiye.163.com;
            # proxy_set_header Host sirius-contact.qiye.163.com;
            proxy_set_header Host sirius-dev1.qiye.163.com;

            # proxy_pass "http://sirius-contact.qiye.163.com/";
            proxy_pass "http://sirius-dev1.qiye.163.com";

            rewrite ^/lx-web/cowork/(.*) /contact/$1 break;
        }

       location /lx-web/feedback {
          proxy_http_version 1.1;
          proxy_set_header Connection "";

          proxy_set_header Origin https://sirius-dev1.qiye.163.com;
          proxy_set_header Host sirius-dev1.qiye.163.com;

          proxy_pass "http://sirius-dev1.qiye.163.com";

          rewrite ^/lx-web/feedback/(.*) /feedback/$1 break;
        }

         location /lx-web/entry {
            proxy_http_version 1.1;
            proxy_set_header Connection "";

             proxy_set_header Origin https://entrydev.qiye.163.com;
             proxy_set_header Host entrydev.qiye.163.com;

             proxy_pass http://QIYELOGIN;

             rewrite ^/lx-web/(.*) /$1 break;
         }

        location /lx-web/bjentry {
            proxy_http_version 1.1;
            proxy_set_header Connection "";

            proxy_set_header Origin https://entrydev.qiye.163.com;
            #proxy_set_header Host entry.qiye.163.com;
            proxy_set_header Host entrydev.qiye.163.com;

            proxy_pass http://entrydev.qiye.163.com;
            proxy_cookie_domain .qiye.163.com .cowork.netease.com;

            rewrite ^/lx-web/bjentry/(.*) /entry/$1 break;
        }

         location /lx-web/js6 {
              proxy_http_version 1.1;
              proxy_set_header Connection "";

             proxy_set_header Origin https://$mail_realhost_ip1:8181;
             proxy_set_header Host $mail_realhost_ip1:8181;

             proxy_pass http://$mail_realhost_ip1:8181;

             rewrite ^/lx-web/(.*) /$1 break;

         }

        location /lx-web/bjjs6 {
             proxy_http_version 1.1;
             proxy_set_header Connection "";

            proxy_set_header Origin https://$mail_realhost_ip1:8181;
            proxy_set_header Host $mail_realhost_ip1:8181;

            # proxy_pass "https://mail.qiye.163.com/";
            proxy_pass http://$mail_realhost_ip1:8181;
            proxy_cookie_domain .qiye.163.com $host;

            rewrite ^/lx-web/bjjs6/(.*) /js6/$1 break;
        }

         location /lx-web/schedulemanager {
             proxy_http_version 1.1;
             proxy_set_header Connection "";

             proxy_set_header Origin https://$mail_realhost_ip1:8181;
             proxy_set_header Host mailhz.qiye.163.com;

#              proxy_pass http://$mail_realhost_ip1:8181;
             proxy_pass http://calendar;

             rewrite ^/lx-web/(.*) /$1 break;
         }

        location /lx-web/bjschedulemanager {
           proxy_http_version 1.1;
           proxy_set_header Connection "";

            proxy_set_header Origin https://$mail_realhost_ip1:8181;
            proxy_set_header Host mail.qiye.163.com;

#             proxy_pass http://$mail_realhost_ip1:8181;
            proxy_pass http://calendar;
            proxy_cookie_domain .qiye.163.com $host;

            rewrite ^/lx-web/bjschedulemanager/(.*) /schedulemanager/$1 break;
        }

         location /lx-web/atthview {
              proxy_http_version 1.1;
              proxy_set_header Connection "";

             proxy_set_header Origin https://$mail_realhost_ip1:8181;
             proxy_set_header Host mailhz.qiye.163.com;

#              proxy_pass http://$mail_realhost_ip1:8181;
             proxy_pass http://10.150.0.2:18090;
             proxy_cookie_domain .qiye.163.com $host;

             rewrite ^/lx-web/(.*) /$1 break;
         }

        location /lx-web/bjatthview {
             proxy_http_version 1.1;
             proxy_set_header Connection "";

            proxy_set_header Origin https://$mail_realhost_ip1:8181;
            proxy_set_header Host mail.qiye.163.com;

#             proxy_pass http://$mail_realhost_ip1:8181;
            proxy_pass http://10.150.0.2:18090;
            proxy_cookie_domain .qiye.163.com $host;

            rewrite ^/lx-web/bjatthview/(.*) /atthview/$1 break;
        }

        location /lx-web/im/api {
            proxy_http_version 1.1;
            proxy_set_header Connection "";

            proxy_set_header Origin https://sirius-dev1.qiye.163.com;
            proxy_set_header Host sirius-dev1.qiye.163.com;

            proxy_pass "http://sirius-dev1.qiye.163.com";
            # proxy_cookie_domain .qiye.163.com $host;

            rewrite ^/lx-web/(.*) /$1 break;
        }

#         location /qiyepush/open {
#             proxy_set_header Origin https://10.194.156.51:8090;
#             proxy_set_header Host $mail_realhost_ip1:8181;
#             # access_log logs/api_access.log main_json;
#             proxy_pass "http://10.194.156.51:8090";
#             # proxy_cookie_domain .qiye.163.com $host;
#         }

#         location /bjqiyepush/open {
#             proxy_set_header Origin https://10.194.156.51:8090;
#             proxy_set_header Host $mail_realhost_ip1:8181;
#             rewrite ^/bjqiyepush/open/(.*) /qiyepush/open/$1 break;
#             proxy_pass "http://10.194.156.51:8090";
#             # proxy_cookie_domain .qiye.163.com $host;
#         }

        # location /preview/ {
        #     proxy_set_header Origin https://$mail_realhost_ip1:8181;
        #     proxy_set_header Host mailhz.qiye.163.com;
        #     # access_log logs/api_access.log main_json;
        #     # proxy_pass "https://mailhz.qiye.163.com";
        #     proxy_pass http://$mail_realhost_ip1:8181;
        #     proxy_cookie_domain .qiye.163.com $host;
        # }

        # location /bjpreview/ {
        #     proxy_set_header Origin https://$mail_realhost_ip1:8181;
        #     proxy_set_header Host mail.qiye.163.com;
        #     # access_log logs/api_access.log main_json;
        #     rewrite ^/bjpreview/(.*) /preview/$1 break;
        #     # proxy_pass "https://mail.qiye.163.com/";
        #     proxy_pass http://$mail_realhost_ip1:8181;
        #     proxy_cookie_domain .qiye.163.com $host;
        # }

        location /lx-web/meeting/api {
            proxy_http_version 1.1;
            proxy_set_header Connection "";

            proxy_set_header Origin https://sirius-dev1.qiye.163.com;
            proxy_set_header Host sirius-dev1.qiye.163.com;
            # rewrite ^/meeting/api/(.*) /api/$1 break;

            proxy_pass "http://sirius-dev1.qiye.163.com";
            proxy_cookie_domain .qiye.163.com $host;

            rewrite ^/lx-web/(.*) /$1 break;
        }

        location /lx-web/commonweb {
            proxy_http_version 1.1;
            proxy_set_header Connection "";

            proxy_set_header Origin https://59.111.229.252:8080;
            proxy_set_header Host mailhz.qiye.163.com;
            # rewrite ^/upxmail/hwup_qiye_163_com(.*) /upxmail/upload$1 break;

#             proxy_pass "http://59.111.229.252:8080";
            proxy_pass http://10.150.0.9:8080;
            # proxy_pass "https://mailhz.qiye.163.com";
            proxy_cookie_domain .qiye.163.com $host;

            rewrite ^/lx-web/(.*) /$1 break;
        }

        location /lx-web/bjcommonweb {
            proxy_http_version 1.1;
            proxy_set_header Connection "";

            proxy_set_header Origin https://mailqa.qiye.163.com;
            proxy_set_header Host mailqa.qiye.163.com;

            # proxy_pass "https://mail.qiye.163.com";
#             proxy_pass http://mailqa.qiye.163.com;
            proxy_pass http://10.150.0.9:8080;
            proxy_cookie_domain .qiye.163.com $host;

            rewrite ^/lx-web/bjcommonweb/(.*) /commonweb/$1 break;
        }

        location /lx-web/rdmailquery {
            proxy_http_version 1.1;
            proxy_set_header Connection "";

            proxy_set_header Origin https://$mail_realhost_ip1:8181;
            proxy_set_header Host mailhz.qiye.163.com;
            # rewrite ^/upxmail/hwup_qiye_163_com(.*) /upxmail/upload$1 break;
            # proxy_pass "https://mailhz.qiye.163.com";

#             proxy_pass http://$mail_realhost_ip1:8181;
            proxy_pass http://RDMAILQUERY;
            proxy_cookie_domain .qiye.163.com $host;

            rewrite ^/lx-web/(.*) /$1 break;
        }

        location /lx-web/bjrdmailquery {
            proxy_http_version 1.1;
            proxy_set_header Connection "";

            proxy_set_header Origin https://$mail_realhost_ip1:8181;
            proxy_set_header Host mail.qiye.163.com;

            # proxy_pass "https://mail.qiye.163.com";
#             proxy_pass http://$mail_realhost_ip1:8181;
            proxy_pass http://RDMAILQUERY;
            proxy_cookie_domain .qiye.163.com $host;

            rewrite ^/lx-web/bjrdmailquery/(.*) /rdmailquery/$1 break;
        }

        location /lx-web/customer/api {
            proxy_http_version 1.1;
            proxy_set_header Connection "";

            proxy_set_header Origin https://sirius-dev1.qiye.163.com;
            proxy_set_header Host sirius-dev1.qiye.163.com;

            proxy_pass "http://sirius-dev1.qiye.163.com";
            proxy_cookie_domain .qiye.163.com $host;

            rewrite ^/lx-web/customer/(.*) /it-customer/$1 break;
        }

        location /lx-web/redirectApi {
            proxy_http_version 1.1;
            proxy_set_header Connection "";

            set $pHost sirius-redirect-dev.qiye.163.com;
            proxy_set_header Origin https://$pHost;
            proxy_set_header Host $pHost;

            proxy_pass http://$pHost;
            proxy_cookie_domain .cowork.netease.com $host;

            rewrite ^/lx-web/redirectApi/(.*) /$1 break;
        }

        location /lx-web/config/api {
            proxy_http_version 1.1;
            proxy_set_header Connection "";

            proxy_set_header Origin https://sirius-dev1.qiye.163.com;
            proxy_set_header Host sirius-dev1.qiye.163.com;

            proxy_pass "http://sirius-dev1.qiye.163.com";
            proxy_cookie_domain .qiye.163.com $host;

            rewrite ^/lx-web/config/(.*) /config-server/$1 break;
        }

        location /lx-web/personal-signature {
            proxy_http_version 1.1;
            proxy_set_header Connection "";

            proxy_set_header Origin https://sirius-dev1.qiye.163.com;
            proxy_set_header Host sirius-dev1.qiye.163.com;

            # rewrite ^/other/(.*) /$1 break;
            proxy_pass "http://sirius-dev1.qiye.163.com";
            proxy_cookie_domain .qiye.163.com $host;

            rewrite ^/lx-web/(.*) /$1 break;
        }

        location /lx-web/device {
            proxy_http_version 1.1;
            proxy_set_header Connection "";

            proxy_set_header Origin https://sirius-dev1.qiye.163.com;
            proxy_set_header Host sirius-dev1.qiye.163.com;

            proxy_pass "http://sirius-dev1.qiye.163.com";
            proxy_cookie_domain .qiye.163.com $host;

            rewrite ^/lx-web/device/(.*) /push/$1 break;
        }

        location /lx-web/biz/api {
            proxy_http_version 1.1;
            proxy_set_header Connection "";

            proxy_set_header Origin https://edisk-test2.qiye.163.com;
            proxy_read_timeout 180;
            proxy_connect_timeout 180;
            proxy_send_timeout 180;
            send_timeout 180;
            proxy_set_header Host edisk-test2.qiye.163.com;
            # proxy_set_header Host edisk.qiye.163.com;

            proxy_pass "http://triones-edisk.cowork-i.netease.com";
            # proxy_pass "http://edisk.qiye.163.com/";

            rewrite ^/lx-web/biz/(.*) /$1 break;
        }

        location /lx-web/edm {
            proxy_http_version 1.1;
            proxy_set_header Connection "";

            proxy_set_header Origin https://sirius-it-edm.cowork.netease.com;
            proxy_set_header Host sirius-it-edm.cowork.netease.com;

            proxy_pass "http://sirius-it-edm.cowork.netease.com";
            proxy_cookie_domain .cowork.netease.com $host;

            rewrite ^/lx-web/edm/(.*) /$1 break;
        }

        location /lx-web/qiyeurs {
            proxy_http_version 1.1;
            proxy_set_header Connection "";

            proxy_set_header Origin https://$mail_realhost_ip1:8181;
            proxy_set_header Host $mail_realhost_ip1:8181;

            # rewrite ^/edm/(.*) /$1 break;
#             proxy_pass http://$mail_realhost_ip1:8181;
            proxy_pass http://10.150.0.3:8080;
            proxy_cookie_domain .qiye.163.com $host;

            rewrite ^/lx-web/(.*) /$1 break;
        }

        location /lx-web/bjqiyeurs {
            proxy_http_version 1.1;
            proxy_set_header Connection "";

            proxy_set_header Origin https://$mail_realhost_ip1:8181;
            proxy_set_header Host $mail_realhost_ip1:8181;

            # proxy_pass "https://mail.qiye.163.com/";
#             proxy_pass http://$mail_realhost_ip1:8181;
            proxy_pass http://10.150.0.3:8080;
            proxy_cookie_domain .qiye.163.com $host;

            rewrite ^/lx-web/bjqiyeurs/(.*) /qiyeurs/$1 break;
        }

        location /lx-web/mailTemplateApi {
            proxy_http_version 1.1;
            proxy_set_header Connection "";

            proxy_set_header Origin https://sirius-dev1.qiye.163.com;
            proxy_set_header Host sirius-dev1.qiye.163.com;

            proxy_pass "http://sirius-dev1.qiye.163.com";
            proxy_cookie_domain .qiye.163.com $host;

            rewrite ^/lx-web/mailTemplateApi/(.*) /template/$1 break;
        }

        location /lx-web/mailpreview/api {
            proxy_http_version 1.1;
            proxy_set_header Connection "";

            proxy_set_header Origin https://file-preview.qiye.163.com;
            proxy_set_header Host file-preview.qiye.163.com;

            proxy_pass "http://file-preview.qiye.163.com";
            proxy_cookie_domain .qiye.163.com $host;

            rewrite ^/lx-web/mailpreview/api/(.*) /api/$1 break;
        }

        location /lx-web/privilege/api {
            proxy_http_version 1.1;
            proxy_set_header Connection "";

            proxy_set_header Origin https://sirius-dev1.qiye.163.com;
            proxy_set_header Host sirius-dev1.qiye.163.com;

            # rewrite ^/privilege/api/(.*) /api/$1 break;
            proxy_pass "http://sirius-dev1.qiye.163.com";
            proxy_cookie_domain .qiye.163.com $host;

            rewrite ^/lx-web/(.*) /$1 break;
        }

        location /lx-web/others/api {
            proxy_http_version 1.1;
            proxy_set_header Connection "";

            proxy_set_header Origin https://sirius-dev1.qiye.163.com;
            proxy_set_header Host sirius-dev1.qiye.163.com;

            # rewrite ^/others/api/(.*) /api/$1 break;
            proxy_pass "http://sirius-dev1.qiye.163.com";
            proxy_cookie_domain .qiye.163.com $host;

            rewrite ^/lx-web/(.*) /$1 break;
        }

        location /lx-web/corp-mail {
            proxy_http_version 1.1;
            proxy_set_header Connection "";

            proxy_set_header Origin https://sirius-dev1.qiye.163.com;
            proxy_set_header Host sirius-dev1.qiye.163.com;

            proxy_pass "http://sirius-dev1.qiye.163.com";
            proxy_cookie_domain .qiye.163.com $host;

            rewrite ^/lx-web/corp-mail/(.*) /bind_hosts/$1 break;
        }

        location /lx-web/praise-mail {
            proxy_http_version 1.1;
            proxy_set_header Connection "";

            proxy_set_header Origin https://sirius-dev1.qiye.163.com;
            proxy_set_header Host sirius-dev1.qiye.163.com;
            # proxy_set_header Host sirius.qiye.163.com;

            proxy_pass "http://sirius-dev1.qiye.163.com";
            # proxy_pass "http://sirius.qiye.163.com";
            proxy_cookie_domain .qiye.163.com $host;

            rewrite ^/lx-web/praise-mail/(.*) /$1 break;
        }

        location /lx-web/service {
            proxy_http_version 1.1;
            proxy_set_header Connection "";

            proxy_set_header Origin https://$mail_realhost_ip1:8181;
            proxy_set_header Host $mail_realhost_ip1:8181;

            proxy_pass http://$mail_realhost_ip1:8181;
            # proxy_pass "https://services.qiye.163.com";
            proxy_cookie_domain .qiye.163.com $host;

            rewrite ^/lx-web/(.*) /$1 break;
        }

        location /lx-web/recent/api {
            proxy_http_version 1.1;
            proxy_set_header Connection "";

            proxy_set_header Origin https://sirius-dev1.qiye.163.com;
            proxy_set_header Host sirius-dev1.qiye.163.com;

            proxy_pass "http://sirius-dev1.qiye.163.com";

            rewrite ^/lx-web/recent/(.*) /recent-contact/$1 break;
        }

        location /lx-web/mail-enhance {
            proxy_http_version 1.1;
            proxy_set_header Connection "";

            proxy_set_header Origin https://sirius-dev1.qiye.163.com;
            proxy_set_header Host sirius-dev1.qiye.163.com;

            proxy_pass "http://sirius-dev1.qiye.163.com";
            proxy_cookie_domain .qiye.163.com $host;

            rewrite ^/lx-web/(.*) /$1 break;
        }

        location /lx-web/smartmailbox/api {
            proxy_http_version 1.1;
            proxy_set_header Connection "";

            proxy_set_header Origin https://sirius-dev1.qiye.163.com;
            proxy_set_header Host sirius-dev1.qiye.163.com;

            proxy_pass "http://sirius-dev1.qiye.163.com";
            proxy_cookie_domain sirius-dev1.qiye.163.com $host;

            rewrite ^/lx-web/smartmailbox/(.*) /contact/$1 break;
        }

        location /lx-web/todo {
            proxy_http_version 1.1;
            proxy_set_header Connection "";

            proxy_set_header Origin https://sirius-dev1.qiye.163.com;
            proxy_set_header Host sirius-dev1.qiye.163.com;

            # rewrite ^/smartmailbox/api/(.*) /api/$1 break;
            proxy_pass "http://sirius-dev1.qiye.163.com";
            proxy_cookie_domain sirius-dev1.qiye.163.com $host;

            rewrite ^/lx-web/(.*) /$1 break;
        }

        location /lx-web/mail-im-team {
            proxy_http_version 1.1;
            proxy_set_header Connection "";

            proxy_set_header Origin https://sirius-dev1.qiye.163.com;
            proxy_set_header Host sirius-dev1.qiye.163.com;

            # rewrite ^/mail-im-team/(.*) /$1 break;
            proxy_pass "http://sirius-dev1.qiye.163.com";
            proxy_cookie_domain .qiye.163.com $host;

            rewrite ^/lx-web/(.*) /$1 break;
        }

        location /lx-web/lxactivity {
            proxy_http_version 1.1;
            proxy_set_header Connection "";

            proxy_set_header Origin https://sirius-dev1.qiye.163.com;
            proxy_set_header Host sirius-dev1.qiye.163.com;

            # rewrite ^/activity/(.*) /$1 break;
            proxy_pass "http://sirius-dev1.qiye.163.com";
            proxy_cookie_domain .qiye.163.com $host;

            rewrite ^/lx-web/lxactivity/(.*) /activity/$1 break;
        }

        location /lx-web/onlinePreview {
            proxy_http_version 1.1;
            proxy_set_header Connection "";

            proxy_set_header Origin https://file-preview.lx.netease.com;
            proxy_set_header Host file-preview.lx.netease.com;

            proxy_pass "http://file-preview.lx.netease.com";
            proxy_cookie_domain .qiye.163.com $host;

            rewrite ^/lx-web/(.*) /$1 break;
        }

        # ******************** for sirius-web **************************** #
    }
    #登录
    server
    {
        listen 80;
        listen 443 ssl;
        server_name entrydev.netease.com entrydev.qiye.163.com entrydev1.qiye.163.com entryhz.qiye.163.com hwentryhz.qiye.163.com entry.qiye.163.com;
        ssl_certificate qiye.163.com.cer.pem;
        ssl_certificate_key qiye.163.com.key.pem;
        ssl_session_cache shared:SSL:5120m;
        ssl_ciphers ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA:ECDHE-RSA-AES256-SHA:DHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA:DHE-RSA-AES256-SHA256:DHE-RSA-AES256-SHA:ECDHE-ECDSA-DES-CBC3-SHA:ECDHE-RSA-DES-CBC3-SHA:EDH-RSA-DES-CBC3-SHA:AES128-GCM-SHA256:AES256-GCM-SHA384:AES128-SHA256:AES256-SHA256:AES128-SHA:AES256-SHA:DES-CBC3-SHA:!DSS;
        ssl_protocols TLSv1 TLSv1.1 TLSv1.2;
        ssl_prefer_server_ciphers on;
        ssl_verify_depth 10;
        ssl_session_timeout 30m;
        location /
        {
            proxy_set_header Host $Host;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            add_header Access-Control-Allow-Origin "https://open.qiye.163.com";
            add_header Access-Control-Allow-Credentials "true";
            add_header Access-Control-Allow-Methods 'POST,GET,OPTIONS';
            add_header Access-Control-Allow-Headers '*';
            proxy_pass http://QIYELOGIN;
        }
        location ^~ /domain/
        {
            rewrite /domain/(.*)$ /login/$1 break;
            proxy_pass http://QIYELOGIN;
            add_header Access-Control-Allow-Origin "https://open.qiye.163.com";
            add_header Access-Control-Allow-Credentials "true";
            add_header Access-Control-Allow-Methods 'POST,GET,OPTIONS';
            add_header Access-Control-Allow-Headers '*';
            proxy_set_header Host $Host;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        }
    }
    #apollo平台
    server
    {
        listen 80 ;
        charset utf-8;
        listen 443 ssl;
        server_name qiyeapollo.dev.netease.com ;
        location ~ ^/apollo
        {
            rewrite ^/apollo/(.*) /$1 break;
            proxy_pass http://APOLLO;
            proxy_read_timeout 7200;
            proxy_connect_timeout 60;
            proxy_set_header Host $Host;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        }
        location /
        {
            proxy_pass http://APOLLO;
            proxy_read_timeout 7200;
            proxy_connect_timeout 60;
            proxy_set_header Host $Host;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        }
    }
    #hmail配置平台 entmail-test-03
    server
    {
        listen 80;
        charset utf-8;
        server_name hmail-dev.netease.com;
        location /
        {
            proxy_pass http://10.150.0.3:9061/;
            proxy_set_header X-Request-Scheme $scheme;
            proxy_set_header Host $host;
        }
    }
    #wework平台
    server
    {
        listen 80;
        charset utf-8;
        listen 443 ssl;
        ssl_certificate qiye.163.com.cer.pem;
        ssl_certificate_key qiye.163.com.key.pem;
        ssl_session_cache shared:SSL:5120m;
        ssl_ciphers ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA:ECDHE-RSA-AES256-SHA:DHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA:DHE-RSA-AES256-SHA256:DHE-RSA-AES256-SHA:ECDHE-ECDSA-DES-CBC3-SHA:ECDHE-RSA-DES-CBC3-SHA:EDH-RSA-DES-CBC3-SHA:AES128-GCM-SHA256:AES256-GCM-SHA384:AES128-SHA256:AES256-SHA256:AES128-SHA:AES256-SHA:DES-CBC3-SHA:!DSS;
        ssl_protocols TLSv1 TLSv1.1 TLSv1.2;
        ssl_prefer_server_ciphers on;
        ssl_verify_depth 10;
        ssl_session_timeout 30m;
        gzip on;
        gzip_min_length 1k;
        gzip_comp_level 9;
        gzip_types text/plain application/javascript application/x-javascript text/css application/xml text/javascript image/jpeg image/gif image/png;
        gzip_vary on;
        gzip_disable "MSIE [1-6]\.";
        server_name weworkdev.qiye.163.com;
        location /
        {
            return 302 https://$host/wework/static/user/login;
        }
        location ^~ /wework/static
        {
            try_files $uri $uri/ /wework/static/index.html;
            alias /data/wework.qiye.163.com/;
        }
        location ^~ /wework/api/
        {
            proxy_pass http://WEWORK_API;
            proxy_set_header Host $host;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        }
        location ^~ /api/
        {
            proxy_pass http://WEWORK_API;
            proxy_set_header Host $host;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        }
        location /gateway/admin/
        {
            proxy_pass http://10.150.0.4:9080/gateway/admin/;
            proxy_set_header Host $host;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        }
        location /log/grafana/
        {
            proxy_pass http://10.150.0.4:9080/log/grafana/;
            proxy_set_header Host $host;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        }
    }
    #注册服务 entmail-test-01
    server
    {
        listen 80;
        listen 443 ssl;
        ssl_certificate qiye.163.com.cer.pem;
        ssl_certificate_key qiye.163.com.key.pem;
        ssl_session_cache shared:SSL:5120m;
        ssl_ciphers ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA:ECDHE-RSA-AES256-SHA:DHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA:DHE-RSA-AES256-SHA256:DHE-RSA-AES256-SHA:ECDHE-ECDSA-DES-CBC3-SHA:ECDHE-RSA-DES-CBC3-SHA:EDH-RSA-DES-CBC3-SHA:AES128-GCM-SHA256:AES256-GCM-SHA384:AES128-SHA256:AES256-SHA256:AES128-SHA:AES256-SHA:DES-CBC3-SHA:!DSS;
        ssl_protocols TLSv1 TLSv1.1 TLSv1.2;
        ssl_prefer_server_ciphers on;
        ssl_verify_depth 10;
        ssl_session_timeout 30m;
        charset utf-8;
        gzip on;
        gzip_min_length 1k;
        gzip_comp_level 9;
        gzip_types text/plain application/javascript application/x-javascript text/css application/xml text/javascript image/jpeg image/gif image/png;
        gzip_vary on;
        gzip_disable "MSIE [1-6]\.";
        server_name services.qiye.163.com;
        location /service/
        {
            proxy_pass http://10.150.0.5:8080/service/;
            proxy_set_header Host $host;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        }
    }
    #搬家
    server
    {
        listen 80;
        listen 443 ssl;
        ssl_certificate qiye.163.com.cer.pem;
        ssl_certificate_key qiye.163.com.key.pem;
        ssl_session_cache shared:SSL:5120m;
        ssl_ciphers ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA:ECDHE-RSA-AES256-SHA:DHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA:DHE-RSA-AES256-SHA256:DHE-RSA-AES256-SHA:ECDHE-ECDSA-DES-CBC3-SHA:ECDHE-RSA-DES-CBC3-SHA:EDH-RSA-DES-CBC3-SHA:AES128-GCM-SHA256:AES256-GCM-SHA384:AES128-SHA256:AES256-SHA256:AES128-SHA:AES256-SHA:DES-CBC3-SHA:!DSS;
        ssl_protocols TLSv1 TLSv1.1 TLSv1.2;
        ssl_prefer_server_ciphers on;
        ssl_verify_depth 10;
        ssl_session_timeout 30m;
        charset utf-8;
        gzip on;
        gzip_min_length 1k;
        gzip_comp_level 9;
        gzip_types text/plain application/javascript application/x-javascript text/css application/xml text/javascript image/jpeg image/gif image/png;
        gzip_vary on;
        gzip_disable "MSIE [1-6]\.";
        server_name movehousehz.qiye.163.com movehousedev.qiye.163.com;
        location /
        {
            root /home/appops/movehouse-front-root/;
            index index.html;
            try_files $uri $uri/ /index.html;
        }
        location /movehouse/v3.0/
        {
            proxy_pass http://10.150.0.5:8089/movehouse/v3.0/;
            proxy_pass_header Location;
            proxy_set_header Host $Host;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        }
    }
    server
    {
        listen 80;
        charset utf-8;
        server_name dev.feedback.qiye.163.com fbdev.qiye.163.com;
        gzip on;
        gzip_min_length 1k;
        gzip_comp_level 9;
        gzip_types text/plain application/javascript application/x-javascript text/css application/xml text/javascript image/jpeg image/gif image/png;
        gzip_vary on;
        gzip_disable "MSIE [1-6]\.";
        location /static/feedback/
        {
            index index.html;
            alias /data/fbhz.qiye.163.com/;
        }
        location /
        {
            proxy_pass http://10.150.0.9:18090/;
        }
    }
    #定位服务等
    server
    {
        listen 80;
        listen 443 ssl;
        ssl_certificate qiye.163.com.cer.pem;
        ssl_certificate_key qiye.163.com.key.pem;
        ssl_session_cache shared:SSL:5120m;
        ssl_ciphers ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA:ECDHE-RSA-AES256-SHA:DHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA:DHE-RSA-AES256-SHA256:DHE-RSA-AES256-SHA:ECDHE-ECDSA-DES-CBC3-SHA:ECDHE-RSA-DES-CBC3-SHA:EDH-RSA-DES-CBC3-SHA:AES128-GCM-SHA256:AES256-GCM-SHA384:AES128-SHA256:AES256-SHA256:AES128-SHA:AES256-SHA:DES-CBC3-SHA:!DSS;
        ssl_protocols TLSv1 TLSv1.1 TLSv1.2;
        ssl_prefer_server_ciphers on;
        ssl_verify_depth 10;
        ssl_session_timeout 30m;
        server_name open.qiye.163.com opendev.qiye.163.com;
        location /qiyeedm
        {
            proxy_pass http://QIYEEDM;
            proxy_set_header Host $host;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        }
        location ~ ^/static
        {
            root /home/appops/open.qiye.163.com/;
            index index.html;
        }
        location /config
        {
            proxy_pass http://QIYECONFIG/qiyeconfig/;
            proxy_set_header Host $host;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        }
        location /qiyeconfig
        {
            proxy_pass http://QIYECONFIG/qiyeconfig;
            proxy_set_header Host $host;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        }
        location ^~ /datacapture
        {
            rewrite /datacapture/(.*)$ /qiye-data-capture/$1 break;
            proxy_pass http://10.150.0.8:8083;
            proxy_set_header Host $host;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        }
        location /
        {
            proxy_pass http://OPENAPP;
            proxy_set_header Host $host;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        }
    }
    #销售后台
    server
    {
        listen 80;
        listen 443 ssl;
        ssl_certificate qiye.163.com.cer.pem;
        ssl_certificate_key qiye.163.com.key.pem;
        ssl_session_cache shared:SSL:5120m;
        ssl_ciphers ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA:ECDHE-RSA-AES256-SHA:DHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA:DHE-RSA-AES256-SHA256:DHE-RSA-AES256-SHA:ECDHE-ECDSA-DES-CBC3-SHA:ECDHE-RSA-DES-CBC3-SHA:EDH-RSA-DES-CBC3-SHA:AES128-GCM-SHA256:AES256-GCM-SHA384:AES128-SHA256:AES256-SHA256:AES128-SHA:AES256-SHA:DES-CBC3-SHA:!DSS;
        ssl_protocols TLSv1 TLSv1.1 TLSv1.2;
        ssl_prefer_server_ciphers on;
        ssl_verify_depth 10;
        ssl_session_timeout 30m;
        server_name salesdev.qiye.163.com;
        location /
        {
            proxy_pass http://QIYESALE;
            proxy_set_header Host $host;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        }
    }
}

